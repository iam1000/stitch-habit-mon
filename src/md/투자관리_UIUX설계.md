# 투자 관리 UI/UX 설계 (Investment Management Design Proposal)

본 문서는 **투자 관리(Investment Management)** 기능을 위한 화면 설계 및 구현 상세 가이드입니다.  
기존의 단순 데이터 조회를 넘어, **직관적인 대시보드 스타일의 UI**와 **효율적인 데이터 입력/수정 프로세스**를 제공하는 것을 목표로 합니다.

---

## 1. 개요 (Overview)

*   **화면명**: 투자 관리 (Investment Management)
*   **진입점**: 사이드바 > `Investment` (투자관리) 메뉴.
*   **목표**:
    *   흩어져 있는 투자 내역(매수/매도)을 통합 관리.
    *   계좌별/종목별 투자 현황을 필터링하여 조회.
    *   엑셀 업로드/다운로드를 통한 대량 데이터 처리 지원.
*   **핵심 가치**:
    *   **Data Integrity**: 구글 시트를 백엔드로 사용하되, 타입 안전성 확보.
    *   **User Experience**: 다크 모드 지원, 인라인 수정, 실시간 필터링.

---

## 2. 화면 레이아웃 (Layout Design)

### 2.1 Wireframe (Actual Implementation)
실제 구현된 레이아웃 구조입니다.

```text
+-----------------------------------------------------------------------------------------------+
|  [ Header: 투자 관리 ]                                                                        |
|  자산 증식을 위한 투자 내역을 관리합니다.                                                     |
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|  [ Tab Navigation ]                                                                           |
|  +-------------------+ +----------------+ +------------------------+ +---------------------+  |
|  | [Icon] 투자내역   | | [Icon] 내역추가| | [Icon] 계좌관리(코드)  | | [Icon] 연동설정     |  |
|  +-------------------+ +----------------+ +------------------------+ +---------------------+  |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+
|  [ Filter Bar ]                                                                               |
|  [ 2024-01-01 ~ 2024-12-31 ]  [ 계좌: 전체(All) (▼) ]  [ 종목명 검색... (Q) ]  [ 엑셀다운 ] |
+-----------------------------------------------------------------------------------------------+
|                                                                                               |
|  [ Data Grid ]                                                                                |
|  +------+------------+------------+-------+-------+---------+-------------+---------+         |
|  | Date | Category   | Stock Name | Type  | Qty   | Price   | Amount      | Action  |         |
|  +------+------------+------------+-------+-------+---------+-------------+---------+         |
|  | [New Row Input Area - Always Visible for Quick Add]                      | [Add]   |         |
|  +------+------------+------------+-------+-------+---------+-------------+---------+         |
|  | 1/20 | 키움증권   | 삼성전자   | [Buy] | 10    | 70,000  | 700,000     | [E] [D] |         |
|  +------+------------+------------+-------+-------+---------+-------------+---------+         |
|  | 1/25 | 토스증권   | 테슬라     | [Sell]| -5    | 250,000 | -1,250,000  | [E] [D] |         |
|  +------+------------+------------+-------+-------+---------+-------------+---------+         |
|                                                                                               |
|  [ Pagination: < 1 2 3 > ]                                                                    |
+-----------------------------------------------------------------------------------------------+
```

### 2.2 Generated Design Preview (by Stitch)
Stitch AI를 활용하여 **현재 소스 코드(`Investment.jsx`)를 기반으로 생성한 UI 시뮬레이션**입니다.

![Investment Dashboard Design](https://lh3.googleusercontent.com/aida/AOfcidUhE_zwT05cKZmoDkHAUCez2prgtCNWuNmZypLvu__-_k_h66IBVJafJg5ONHEtoAufDTKZcBWUmX69ikGrArCHMoh0Shpvp5VpGf5K1LENnx2niD1P2qsOXNs2u0Uk5QtpxrvwyE4bpraL94ux1ohutf1wwiTDUMlFmYs4m-R2leWhnJmA-gkZRWLeUeV99abHQQ_B9qYKsCjcEzS9iVn4qudqzFXFc2WMgpiY75TpPkNSmWPGrn55V-0)

---

## 3. 상세 컴포넌트 설계

### 3.1 탭 구성 (Tabs)
1.  **투자내역 (List)**: 메인 조회 화면. 필터 및 그리드 제공.
2.  **내역추가 (Add)**: (레거시) 대량 등록 또는 상세 입력 폼. 현재는 `List` 탭의 상단 고정 `Add Row`를 권장.
3.  **계좌관리 (Code Mapping)**: `ACCOUNTS` 시트의 계좌 정보를 관리.
    *   금융기관, 계좌명, 계좌유형(ISA, 연금저축 등) 관리.
4.  **연동설정 (Settings)**: 구글 시트 ID 및 인증 정보 설정.

### 3.2 필터 바 (Filter Bar)
*   **기간 조회**: `startDate`, `endDate` (HTML5 date picker).
*   **계좌 필터**: `useDataMapper` 훅을 통해 `ACCOUNTS` 시트의 `account_name`을 로드하여 드롭다운 구성.
*   **검색**: 종목명(`item_name`) 텍스트 검색.
*   **엑셀 다운로드**: 현재 필터링된 데이터를 `.xlsx` 포맷으로 클라이언트 사이드 생성(`exceljs`).

### 3.3 데이터 테이블 (Data Table)
*   **Sortable Header**: 헤더 클릭 시 오름차순/내림차순/초기화 정렬 로테이션.
*   **Badges**:
    *   Category: 파란색/보라색 뱃지로 계좌 구분.
    *   Type: 매수(Buy)는 붉은색, 매도(Sell)는 파란색 텍스트/뱃지로 시각적 구분.
*   **Inline Edit**:
    *   수정 버튼 클릭 시 해당 행이 `input/select`로 전환.
    *   `Save` 클릭 시 `PUT /api/update` 호출 후 UI 낙관적 업데이트.

---

## 4. 데이터 로직 및 스키마 (Technical Spec)

### 4.1 구글 시트 스키마 (`INVESTMENT`)
| 컬럼 키 (Key) | 설명 | 데이터 예시 | 비고 |
| :--- | :--- | :--- | :--- |
| **uuid** | 고유 식별자 | `550e8400...` | 필수 (PK) |
| **date** | 거래일 | `2024-01-20` | YYYY-MM-DD |
| **category** | 계좌 ID | `101` | `ACCOUNTS` 시트와 FK 관계 |
| **item_name** | 종목명 | `Apple Inc.` | |
| **type** | 거래 유형 | `BUY`, `SELL` | |
| **qty** | 수량 | `10`, `-5` | 매도는 음수(-) 관례 사용 가능 |
| **price** | 단가 | `150.5` | |
| **amount** | 총액 | `1505` | 수식 또는 값 저장 |

### 4.2 계좌 매핑 로직 (`useDataMapper`)
*   **Problem**: `INVESTMENT` 시트에는 `category` 컬럼에 숫자 ID(`101`)만 저장됨.
*   **Solution**:
    1.  `ACCOUNTS` 시트를 조회하여 매핑 테이블(`{ 101: "키움증권", ... }`) 생성.
    2.  화면 렌더링 시 ID를 사람이 읽을 수 있는 이름으로 실시간 변환.
    3.  필터 드롭다운에도 매핑된 이름 목록 표시.

### 4.3 API 통신
*   **Method**: Netlify Functions (Serverless).
*   **Endpoints**:
    *   `GET /api/data`: 데이터 조회 (필터링 포함).
    *   `POST /api/add`: 신규 행 추가.
    *   `PUT /api/update`: 기존 행 수정.
    *   `DELETE /api/delete`: 행 삭제.

---

## 5. 개발 환경 및 라이브러리

*   **Framework**: React 18, Vite.
*   **Languages**: JavaScript, JSX.
*   **Styling**: Tailwind CSS (Dark Mode 지원).
*   **Icons**: `lucide-react` (금융 및 UI 아이콘).
*   **Excel**: `exceljs` (브라우저 내 엑셀 생성).
*   **State Management**: `useState` (로컬 상태), `Context API` (언어/테마).

---

## 6. 향후 개선 사항

*   **차트 연동**: 우측 상단이나 별도 탭에 단순 자산 추이 그래프 추가.
*   **대량 업로드**: 엑셀 파일을 드래그하여 일괄 등록하는 기능.
*   **수익률 자동 계산**: 매수/매도 내역을 분석하여 실현 손익 표시.
